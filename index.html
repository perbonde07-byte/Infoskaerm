<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <title>TV Info Skærm</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{ --bg:#0b1220; --fg:#e8eefb; --muted:#9fb2d1; --acc:#5aa2ff }
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--fg);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial;
      overflow:hidden;
    }
    header{padding:18px; border-bottom:1px solid rgba(255,255,255,.06)}
    .screen{height:calc(100% - 70px); display:flex; align-items:center; justify-content:center}
    .card{max-width:1200px; padding:32px; border-radius:18px; background:#0e172a; border:1px solid rgba(255,255,255,.06)}
    h1{margin:0 0 12px}
    ul{margin:8px 0 0 20px}
    img{max-width:96vw; max-height:70vh; border-radius:16px; border:1px solid rgba(255,255,255,.06)}
    .muted{color:var(--muted)}
    .topbar{display:flex; align-items:center; gap:14px; justify-content:space-between}
  </style>
</head>
<body>
<header class="topbar">
  <div style="padding-left:10px"><b id="brand">Info</b></div>
  <div class="muted" style="padding-right:10px">
    <span id="clock"></span>
  </div>
</header>

<div class="screen">
  <div class="card" id="slideBox">Indlæser…</div>
</div>

<script>
  const DATA_URL = "https://perbonde07-byte.github.io/Infoskaerm/data.json";
  let slides = [], idx = 0, timer = null;

  function fmtClock(){
    const d = new Date();
    return d.toLocaleTimeString('da-DK', { hour:'2-digit', minute:'2-digit'});
  }
  setInterval(()=>{ document.getElementById('clock').textContent = fmtClock(); }, 1000);

  function show(slide){
    const box = document.getElementById('slideBox');
    if (!slide) { box.textContent = 'Ingen slides'; return; }

    if (slide.type === 'image' && slide.image){
      box.innerHTML = `<img src="${slide.image}" alt="">`;
    } else {
      const lines = (slide.lines||[]).map(x=>`<li>${x}</li>`).join('');
      box.innerHTML = `<h1>${slide.title||''}</h1><ul>${lines}</ul>`;
    }
  }

  function rotate(){
    if (!slides.length) return;
    const s = slides[idx % slides.length];
    show(s);
    clearTimeout(timer);
    const dur = Math.max(3, +s.duration || 12) * 1000;
    timer = setTimeout(()=>{
      idx++; rotate();
    }, dur);
  }

  async function boot(){
    try{
      const r = await fetch(DATA_URL + '?v=' + Date.now());
      const data = await r.json();
      document.getElementById('brand').textContent = data.brand || 'Info';
      slides = data.slides || [];
      idx = 0;
      rotate();
    } catch(e){
      document.getElementById('slideBox').textContent = 'Kan ikke hente data.json';
    }
  }
  boot();
</script>
</body>
</html>
